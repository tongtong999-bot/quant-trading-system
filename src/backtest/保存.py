import pandas as pd
from pathlib import Path
from datetime import datetime
import json

# åˆ›å»ºè¾“å‡ºç›®å½•
output_dir = Path("æ³¢åŠ¨æ€§æ”¶å‰²æœºç­–ç•¥å›æµ‹æŠ¥å‘Š")
output_dir.mkdir(exist_ok=True)

# ç­–ç•¥æ¦‚è¿°ä¿¡æ¯
strategy_info = [
    {"é¡¹ç›®": "ç­–ç•¥åç§°", "å†…å®¹": "æ³¢åŠ¨æ€§æ”¶å‰²æœºç­–ç•¥ï¼ˆDynamic Delta Managementï¼‰"},
    {"é¡¹ç›®": "æ ¸å¿ƒç†å¿µ", "å†…å®¹": "åŸºäºè¶‹åŠ¿åˆ¤æ–­èƒ½åŠ›çš„åŠ¨æ€Deltaç®¡ç†ç³»ç»Ÿ"},
    {"é¡¹ç›®": "æ‰§è¡ŒåŸåˆ™", "å†…å®¹": "å³ä¾§äº¤æ˜“+å¤šé‡ç¡®è®¤+ä¸¥æ ¼é£æ§"},
    {"é¡¹ç›®": "é€‚ç”¨èŒƒå›´", "å†…å®¹": "é«˜æ³¢åŠ¨æ€§ã€æµåŠ¨æ€§å……è¶³çš„åŠ å¯†è´§å¸å¸‚åœº"},
    {"é¡¹ç›®": "é£é™©ç­‰çº§", "å†…å®¹": "ä¸­ä½é£é™©ï¼ˆä¸¥æ ¼é£æ§ä½“ç³»ï¼‰"},
    {"é¡¹ç›®": "é¢„æœŸå¹´åŒ–æ”¶ç›Š", "å†…å®¹": "200-350%ï¼ˆè€ƒè™‘æœºä¼šé¢‘ç‡ï¼‰"}
]

# è¡¨1ï¼šæ ¸å¿ƒæ‰§è¡Œæ•°æ®
cases_data = [
    {"åºå·": 1, "å¸ç§": "WLFI", "å¸‚åœºç¯å¢ƒ": "åŒå‘æ³¢åŠ¨å‹", "å‘¨æœŸå¤©æ•°": 15, "å»ºä»“ä»·æ ¼": 0.24, "å¹³ä»“ä»·æ ¼": "0.39/0.17", "å‡€æ”¶ç›ŠU": 500.90, "ROI": "25.05%", "éªŒè¯ä»·å€¼": "å®Œæ•´å‘¨æœŸé€‚åº”æ€§"},
    {"åºå·": 2, "å¸ç§": "SOMI", "å¸‚åœºç¯å¢ƒ": "å•è¾¹ä¸Šæ¶¨å‹", "å‘¨æœŸå¤©æ•°": 2.5, "å»ºä»“ä»·æ ¼": 0.41, "å¹³ä»“ä»·æ ¼": "0.68", "å‡€æ”¶ç›ŠU": 217.39, "ROI": "10.87%", "éªŒè¯ä»·å€¼": "Vå‹åè½¬æ•è·èƒ½åŠ›"},
    {"åºå·": 3, "å¸ç§": "BTR", "å¸‚åœºç¯å¢ƒ": "å•è¾¹ä¸‹è·Œå‹", "å‘¨æœŸå¤©æ•°": 5, "å»ºä»“ä»·æ ¼": 0.078, "å¹³ä»“ä»·æ ¼": "0.074/0.056", "å‡€æ”¶ç›ŠU": 123.56, "ROI": "6.18%", "éªŒè¯ä»·å€¼": "ç†Šå¸‚é˜²å®ˆåå‡»èƒ½åŠ›"},
    {"åºå·": 4, "å¸ç§": "ARIA", "å¸‚åœºç¯å¢ƒ": "æ··æ²Œéœ‡è¡å‹", "å‘¨æœŸå¤©æ•°": 4, "å»ºä»“ä»·æ ¼": "-", "å¹³ä»“ä»·æ ¼": "-", "å‡€æ”¶ç›ŠU": 0.00, "ROI": "0%", "éªŒè¯ä»·å€¼": "æ™ºèƒ½è¿‡æ»¤æœºåˆ¶"},
    {"åºå·": 5, "å¸ç§": "MITO", "å¸‚åœºç¯å¢ƒ": "å¤æ‚å¤šå˜å‹", "å‘¨æœŸå¤©æ•°": 1.5, "å»ºä»“ä»·æ ¼": 0.175, "å¹³ä»“ä»·æ ¼": "0.170/0.145", "å‡€æ”¶ç›ŠU": 81.49, "ROI": "4.07%", "éªŒè¯ä»·å€¼": "é€‰æ‹©æ€§æ‰§è¡Œçºªå¾‹"},
    {"åºå·": 6, "å¸ç§": "PTB", "å¸‚åœºç¯å¢ƒ": "ç†æƒ³ä¸Šæ¶¨å‹", "å‘¨æœŸå¤©æ•°": 2.5, "å»ºä»“ä»·æ ¼": 0.031, "å¹³ä»“ä»·æ ¼": "0.051", "å‡€æ”¶ç›ŠU": 226.20, "ROI": "11.31%", "éªŒè¯ä»·å€¼": "ç†æƒ³ç¯å¢ƒè¡¨ç°"},
    {"åºå·": 7, "å¸ç§": "TAKE", "å¸‚åœºç¯å¢ƒ": "ç¼“æ…¢ä¸‹è·Œå‹", "å‘¨æœŸå¤©æ•°": 1.5, "å»ºä»“ä»·æ ¼": 0.175, "å¹³ä»“ä»·æ ¼": "0.170/0.145", "å‡€æ”¶ç›ŠU": 57.16, "ROI": "2.86%", "éªŒè¯ä»·å€¼": "ç¼“è¶‹åŠ¿é€‚åº”æ€§"},
    {"åºå·": 8, "å¸ç§": "M", "å¸‚åœºç¯å¢ƒ": "è¶…çº§çˆ†å‘å‹", "å‘¨æœŸå¤©æ•°": 12, "å»ºä»“ä»·æ ¼": 0.45, "å¹³ä»“ä»·æ ¼": "1.45", "å‡€æ”¶ç›ŠU": 1776.00, "ROI": "88.80%", "éªŒè¯ä»·å€¼": "æé™æ‰§è¡Œçºªå¾‹"}
]

# è¡¨2ï¼šæ”¶ç›Šæ„æˆåˆ†æ
profit_breakdown = [
    {"å¸ç§": "WLFI", "ç°è´§æ”¶ç›ŠU": 625.00, "ç©ºå•æˆæœ¬U": -362.50, "æ¯›åˆ©æ¶¦U": 262.50, "äº¤æ˜“æˆæœ¬U": 192.50, "å‡€æ”¶ç›ŠU": 500.90, "æˆæœ¬ç‡": "9.6%"},
    {"å¸ç§": "SOMI", "ç°è´§æ”¶ç›ŠU": 658.53, "ç©ºå•æˆæœ¬U": -380.64, "æ¯›åˆ©æ¶¦U": 277.89, "äº¤æ˜“æˆæœ¬U": 60.50, "å‡€æ”¶ç›ŠU": 217.39, "æˆæœ¬ç‡": "2.8%"},
    {"å¸ç§": "BTR", "ç°è´§æ”¶ç›ŠU": -51.28, "ç©ºå•æ”¶ç›ŠU": 212.84, "æ¯›åˆ©æ¶¦U": 161.56, "äº¤æ˜“æˆæœ¬U": 38.00, "å‡€æ”¶ç›ŠU": 123.56, "æˆæœ¬ç‡": "1.9%"},
    {"å¸ç§": "ARIA", "ç°è´§æ”¶ç›ŠU": 0.00, "ç©ºå•æ”¶ç›ŠU": 0.00, "æ¯›åˆ©æ¶¦U": 0.00, "äº¤æ˜“æˆæœ¬U": 0.00, "å‡€æ”¶ç›ŠU": 0.00, "æˆæœ¬ç‡": "0%"},
    {"å¸ç§": "MITO", "ç°è´§æ”¶ç›ŠU": -28.57, "ç©ºå•æ”¶ç›ŠU": 125.73, "æ¯›åˆ©æ¶¦U": 97.16, "äº¤æ˜“æˆæœ¬U": 40.00, "å‡€æ”¶ç›ŠU": 81.49, "æˆæœ¬ç‡": "2.0%"},
    {"å¸ç§": "PTB", "ç°è´§æ”¶ç›ŠU": 645.16, "ç©ºå•æˆæœ¬U": -370.96, "æ¯›åˆ©æ¶¦U": 274.20, "äº¤æ˜“æˆæœ¬U": 48.00, "å‡€æ”¶ç›ŠU": 226.20, "æˆæœ¬ç‡": "2.4%"},
    {"å¸ç§": "TAKE", "ç°è´§æ”¶ç›ŠU": -28.57, "ç©ºå•æ”¶ç›ŠU": 125.73, "æ¯›åˆ©æ¶¦U": 97.16, "äº¤æ˜“æˆæœ¬U": 40.00, "å‡€æ”¶ç›ŠU": 57.16, "æˆæœ¬ç‡": "2.0%"},
    {"å¸ç§": "M", "ç°è´§æ”¶ç›ŠU": 2222.00, "ç©ºå•æˆæœ¬U": -371.00, "æ¯›åˆ©æ¶¦U": 1851.00, "äº¤æ˜“æˆæœ¬U": 75.00, "å‡€æ”¶ç›ŠU": 1776.00, "æˆæœ¬ç‡": "3.8%"}
]

# è¡¨3ï¼šæ ¸å¿ƒKPIç»Ÿè®¡
kpi_summary = [
    {"æŒ‡æ ‡ç±»åˆ«": "æˆåŠŸç‡æŒ‡æ ‡", "å…·ä½“æŒ‡æ ‡": "æ€»ä½“èƒœç‡", "æ•°å€¼": "87.5%", "è¯„çº§": "ä¼˜ç§€", "å¤‡æ³¨": "7/8ï¼Œå«è§‚æœ›æ¡ˆä¾‹"},
    {"æŒ‡æ ‡ç±»åˆ«": "æˆåŠŸç‡æŒ‡æ ‡", "å…·ä½“æŒ‡æ ‡": "æ‰§è¡Œæ ·æœ¬èƒœç‡", "æ•°å€¼": "100%", "è¯„çº§": "å®Œç¾", "å¤‡æ³¨": "7/7ï¼Œå‚ä¸äº¤æ˜“æ ·æœ¬"},
    {"æŒ‡æ ‡ç±»åˆ«": "æˆåŠŸç‡æŒ‡æ ‡", "å…·ä½“æŒ‡æ ‡": "èµ„æœ¬ä¿æŠ¤æˆåŠŸç‡", "æ•°å€¼": "100%", "è¯„çº§": "å®Œç¾", "å¤‡æ³¨": "8/8ï¼Œé›¶äºæŸè®°å½•"},
    {"æŒ‡æ ‡ç±»åˆ«": "æ”¶ç›ŠæŒ‡æ ‡", "å…·ä½“æŒ‡æ ‡": "æ€»å‡€æ”¶ç›Š", "æ•°å€¼": "2982.7U", "è¯„çº§": "-", "å¤‡æ³¨": "8æ¡ˆä¾‹åˆè®¡"},
    {"æŒ‡æ ‡ç±»åˆ«": "æ”¶ç›ŠæŒ‡æ ‡", "å…·ä½“æŒ‡æ ‡": "å¹³å‡æ”¶ç›Šç‡", "æ•°å€¼": "21.31%", "è¯„çº§": "ä¼˜ç§€", "å¤‡æ³¨": "ä»…ç›ˆåˆ©æ ·æœ¬"},
    {"æŒ‡æ ‡ç±»åˆ«": "æ”¶ç›ŠæŒ‡æ ‡", "å…·ä½“æŒ‡æ ‡": "ä¸­ä½æ•°æ”¶ç›Šç‡", "æ•°å€¼": "10.87%", "è¯„çº§": "è‰¯å¥½", "å¤‡æ³¨": "æ›´ç¨³å¥æœŸæœ›"},
    {"æŒ‡æ ‡ç±»åˆ«": "æ”¶ç›ŠæŒ‡æ ‡", "å…·ä½“æŒ‡æ ‡": "æœ€å¤§å•æ¬¡æ”¶ç›Š", "æ•°å€¼": "88.80%", "è¯„çº§": "å“è¶Š", "å¤‡æ³¨": "Mæ¡ˆä¾‹è¡¨ç°"},
    {"æŒ‡æ ‡ç±»åˆ«": "é£é™©æŒ‡æ ‡", "å…·ä½“æŒ‡æ ‡": "æœ€å¤§å›æ’¤", "æ•°å€¼": "0%", "è¯„çº§": "å®Œç¾", "å¤‡æ³¨": "æ— äºæŸé€€å‡º"},
    {"æŒ‡æ ‡ç±»åˆ«": "é£é™©æŒ‡æ ‡", "å…·ä½“æŒ‡æ ‡": "å¹³å‡æŒä»“æ—¶é—´", "æ•°å€¼": "5.5å¤©", "è¯„çº§": "-", "å¤‡æ³¨": "å¿«é€Ÿå‘¨è½¬"},
    {"æŒ‡æ ‡ç±»åˆ«": "é£é™©æŒ‡æ ‡", "å…·ä½“æŒ‡æ ‡": "é£é™©è°ƒæ•´å¹´åŒ–æ”¶ç›Š", "æ•°å€¼": "200-350%", "è¯„çº§": "ä¼˜ç§€", "å¤‡æ³¨": "è€ƒè™‘æœºä¼šé¢‘ç‡"}
]

# è¡¨4ï¼šæ”¶ç›Šåˆ†å¸ƒ
profit_distribution = [
    {"æ”¶ç›ŠåŒºé—´": "è¶…é«˜æ”¶ç›Š(>50%)", "æ¡ˆä¾‹æ•°": 1, "å æ¯”": "12.5%", "ä»£è¡¨æ¡ˆä¾‹": "M(88.8%)", "ç‰¹å¾": "æç«¯è¡Œæƒ…æ•è·"},
    {"æ”¶ç›ŠåŒºé—´": "é«˜æ”¶ç›Š(20-50%)", "æ¡ˆä¾‹æ•°": 1, "å æ¯”": "12.5%", "ä»£è¡¨æ¡ˆä¾‹": "WLFI(25.05%)", "ç‰¹å¾": "å®Œæ•´å‘¨æœŸæ”¶ç›Š"},
    {"æ”¶ç›ŠåŒºé—´": "ä¸­ç­‰æ”¶ç›Š(10-20%)", "æ¡ˆä¾‹æ•°": 2, "å æ¯”": "25%", "ä»£è¡¨æ¡ˆä¾‹": "SOMI,PTB", "ç‰¹å¾": "æ ‡å‡†è¶‹åŠ¿æ•è·"},
    {"æ”¶ç›ŠåŒºé—´": "ä½æ”¶ç›Š(5-10%)", "æ¡ˆä¾‹æ•°": 1, "å æ¯”": "12.5%", "ä»£è¡¨æ¡ˆä¾‹": "BTR(6.18%)", "ç‰¹å¾": "é˜²å®ˆå‹æ”¶ç›Š"},
    {"æ”¶ç›ŠåŒºé—´": "å¾®æ”¶ç›Š(0-5%)", "æ¡ˆä¾‹æ•°": 2, "å æ¯”": "25%", "ä»£è¡¨æ¡ˆä¾‹": "MITO,TAKE", "ç‰¹å¾": "é€‰æ‹©æ€§å‚ä¸"},
    {"æ”¶ç›ŠåŒºé—´": "é›¶æ”¶ç›Š", "æ¡ˆä¾‹æ•°": 1, "å æ¯”": "12.5%", "ä»£è¡¨æ¡ˆä¾‹": "ARIA(0%)", "ç‰¹å¾": "æ™ºèƒ½è§‚æœ›"}
]

# è¡¨5ï¼šç¯å¢ƒè¡¨ç°åˆ†æ
env_performance = [
    {"ç¯å¢ƒç±»å‹": "å¼ºåŠ¿ä¸Šæ¶¨", "æ¡ˆä¾‹æ•°": 3, "å¹³å‡æ”¶ç›Šç‡": "37.01%", "èƒœç‡": "100%", "é€‚ç”¨æ€§": "â˜…â˜…â˜…â˜…â˜…", "éš¾åº¦": "ä¸­ç­‰", "é£é™©": "ä¸­ä½"},
    {"ç¯å¢ƒç±»å‹": "å•è¾¹ä¸‹è·Œ", "æ¡ˆä¾‹æ•°": 2, "å¹³å‡æ”¶ç›Šç‡": "4.52%", "èƒœç‡": "100%", "é€‚ç”¨æ€§": "â˜…â˜…â˜…â˜…", "éš¾åº¦": "ä¸­ç­‰", "é£é™©": "ä½"},
    {"ç¯å¢ƒç±»å‹": "åŒå‘æ³¢åŠ¨", "æ¡ˆä¾‹æ•°": 1, "å¹³å‡æ”¶ç›Šç‡": "25.05%", "èƒœç‡": "100%", "é€‚ç”¨æ€§": "â˜…â˜…â˜…â˜…â˜…", "éš¾åº¦": "è¾ƒé«˜", "é£é™©": "ä¸­ç­‰"},
    {"ç¯å¢ƒç±»å‹": "æ··æ²Œéœ‡è¡", "æ¡ˆä¾‹æ•°": 2, "å¹³å‡æ”¶ç›Šç‡": "2.04%", "èƒœç‡": "50%", "é€‚ç”¨æ€§": "â˜…(è§‚æœ›)", "éš¾åº¦": "ä½", "é£é™©": "é›¶"}
]

# è¡¨6ï¼šç­–ç•¥åº”å¯¹æ‰‹å†Œ
strategy_playbook = [
    {"ç¯å¢ƒç±»å‹": "ç†æƒ³ä¸Šæ¶¨", "æŠ€æœ¯ç‰¹å¾": "HH-HL+æ”¾é‡çªç ´", "ç­–ç•¥åº”å¯¹": "åˆ†æ‰¹å‡ç©ºé‡Šæ”¾æ½œåŠ›", "é¢„æœŸæ”¶ç›Š": "8-25%", "æˆåŠŸå› ç´ ": "è¶‹åŠ¿è¯†åˆ«+åˆ†æ‰¹çºªå¾‹"},
    {"ç¯å¢ƒç±»å‹": "è¶…çº§çˆ†å‘", "æŠ€æœ¯ç‰¹å¾": "å‚ç›´æ‹‰å‡+å·¨é‡", "ç­–ç•¥åº”å¯¹": "ä¸¥æ ¼åˆ†æ‰¹+çºªå¾‹æ­¢ç›ˆ", "é¢„æœŸæ”¶ç›Š": "20-90%", "æˆåŠŸå› ç´ ": "æå¼ºæ‰§è¡Œçºªå¾‹"},
    {"ç¯å¢ƒç±»å‹": "æŒç»­ä¸‹è·Œ", "æŠ€æœ¯ç‰¹å¾": "LL-LH+æ”¾é‡ä¸‹è·Œ", "ç­–ç•¥åº”å¯¹": "å–ç°è´§è½¬çº¯ç©º", "é¢„æœŸæ”¶ç›Š": "3-8%", "æˆåŠŸå› ç´ ": "è½¬æ¢æ—¶æœºæŠŠæ¡"},
    {"ç¯å¢ƒç±»å‹": "åŒå‘æ³¢åŠ¨", "æŠ€æœ¯ç‰¹å¾": "å®Œæ•´å‘¨æœŸæ³¢åŠ¨", "ç­–ç•¥åº”å¯¹": "åŒå‘æ•è·æ”¶ç›Š", "é¢„æœŸæ”¶ç›Š": "15-30%", "æˆåŠŸå› ç´ ": "å…¨å‘¨æœŸç®¡ç†"},
    {"ç¯å¢ƒç±»å‹": "æ··æ²Œéœ‡è¡", "æŠ€æœ¯ç‰¹å¾": "ç¼ºä¹æŒç»­è¶‹åŠ¿", "ç­–ç•¥åº”å¯¹": "ä¸¥æ ¼è§‚æœ›ä¿æŠ¤", "é¢„æœŸæ”¶ç›Š": "0%", "æˆåŠŸå› ç´ ": "è¿‡æ»¤çºªå¾‹"}
]

# è¡¨7ï¼šå»ºä»“æ£€æŸ¥æ¸…å•
entry_checklist = [
    {"æ£€æŸ¥é¡¹ç›®": "æµåŠ¨æ€§è¦æ±‚", "æ ‡å‡†": "5æ¡£æ·±åº¦â‰¥50,000U", "é‡è¦æ€§": "å¿…è¦æ¡ä»¶", "æ£€æŸ¥æ–¹æ³•": "å®æ—¶ç›‘æ§ç›˜å£"},
    {"æ£€æŸ¥é¡¹ç›®": "ä»·å·®æ§åˆ¶", "æ ‡å‡†": "ä¹°å–ä»·å·®â‰¤30bps", "é‡è¦æ€§": "å¿…è¦æ¡ä»¶", "æ£€æŸ¥æ–¹æ³•": "æˆæœ¬è®¡ç®—ç¡®è®¤"},
    {"æ£€æŸ¥é¡¹ç›®": "æŠ€æœ¯ç»“æ„", "æ ‡å‡†": "HH-HL/LL-LHç¡®è®¤", "é‡è¦æ€§": "æ ¸å¿ƒæ¡ä»¶", "æ£€æŸ¥æ–¹æ³•": "å¤šå‘¨æœŸéªŒè¯"},
    {"æ£€æŸ¥é¡¹ç›®": "æˆäº¤é‡ç¡®è®¤", "æ ‡å‡†": "çªç ´æ”¾é‡â‰¥30%", "é‡è¦æ€§": "é‡è¦æ¡ä»¶", "æ£€æŸ¥æ–¹æ³•": "é‡ä»·é…åˆæ£€æŸ¥"},
    {"æ£€æŸ¥é¡¹ç›®": "å‡çº¿é…åˆ", "æ ‡å‡†": "EMA20/50æ–¹å‘ä¸€è‡´", "é‡è¦æ€§": "é‡è¦æ¡ä»¶", "æ£€æŸ¥æ–¹æ³•": "æŠ€æœ¯æŒ‡æ ‡ç¡®è®¤"},
    {"æ£€æŸ¥é¡¹ç›®": "å³ä¾§äº¤æ˜“", "æ ‡å‡†": "3æ ¹Kçº¿ç¡®è®¤çªç ´", "é‡è¦æ€§": "æ ¸å¿ƒåŸåˆ™", "æ£€æŸ¥æ–¹æ³•": "é¿å…å‡çªç ´"}
]

# è¡¨8ï¼šåŠ¨æ€ä»“ä½ç®¡ç†
position_management = [
    {"å¸‚åœºçŠ¶æ€": "ä¸Šæ¶¨è¶‹åŠ¿", "è§¦å‘æ¡ä»¶": "+20%/+35%/+50%", "æ“ä½œæ–¹å¼": "åˆ†æ‰¹å¹³ç©º30%/30%/40%", "ä»“ä½å˜åŒ–": "é€æ­¥å‡ç©º", "æ•å£å˜åŒ–": "0%â†’100%å¤šå¤´"},
    {"å¸‚åœºçŠ¶æ€": "ä¸‹è·Œè¶‹åŠ¿", "è§¦å‘æ¡ä»¶": "è¶‹åŠ¿ç¡®è®¤", "æ“ä½œæ–¹å¼": "å–ç°è´§è½¬çº¯ç©º", "ä»“ä½å˜åŒ–": "ä¸€æ¬¡æ€§è½¬æ¢", "æ•å£å˜åŒ–": "0%â†’100%ç©ºå¤´"},
    {"å¸‚åœºçŠ¶æ€": "éœ‡è¡çŠ¶æ€", "è§¦å‘æ¡ä»¶": "ç¼ºä¹æ˜ç¡®æ–¹å‘", "æ“ä½œæ–¹å¼": "ç»´æŒä¸­æ€§/è§‚æœ›", "ä»“ä½å˜åŒ–": "ä¸å˜", "æ•å£å˜åŒ–": "ä¿æŒ0%"},
    {"å¸‚åœºçŠ¶æ€": "ä¸ç¡®å®š", "è§¦å‘æ¡ä»¶": "ä¿¡å·æ··ä¹±", "æ“ä½œæ–¹å¼": "å¼ºåˆ¶è§‚æœ›", "ä»“ä½å˜åŒ–": "ä¸å‚ä¸", "æ•å£å˜åŒ–": "0%"}
]

# è¡¨9ï¼šé£é™©æ§åˆ¶è§„åˆ™
risk_rules = [
    {"é£æ§ç±»å‹": "ä»“ä½é£æ§", "è§„åˆ™": "å‡€æ•å£â‰¤30%", "è§¦å‘æ¡ä»¶": "å®æ—¶ç›‘æ§", "åº”å¯¹æªæ–½": "ç«‹å³å‡ä»“", "ä¼˜å…ˆçº§": "æœ€é«˜"},
    {"é£æ§ç±»å‹": "äºæŸé£æ§", "è§„åˆ™": "å•æ¬¡äºæŸâ‰¤15%", "è§¦å‘æ¡ä»¶": "æµ®äºè¾¾æ ‡", "åº”å¯¹æªæ–½": "å¼ºåˆ¶æ­¢æŸ", "ä¼˜å…ˆçº§": "æœ€é«˜"},
    {"é£æ§ç±»å‹": "æ—¶é—´é£æ§", "è§„åˆ™": "12å°æ—¶æœªç¡®è®¤", "è§¦å‘æ¡ä»¶": "æ‹†è…¿åè®¡æ—¶", "åº”å¯¹æªæ–½": "å›å½’ä¸­æ€§", "ä¼˜å…ˆçº§": "é«˜"},
    {"é£æ§ç±»å‹": "ä»·æ ¼é£æ§", "è§„åˆ™": "çªç ´æ‹†è…¿ç‚¹Â±10%", "è§¦å‘æ¡ä»¶": "ä»·æ ¼è§¦å‘", "åº”å¯¹æªæ–½": "ç«‹å³å›è¡¥", "ä¼˜å…ˆçº§": "é«˜"},
    {"é£æ§ç±»å‹": "ä¿è¯é‡‘é£æ§", "è§„åˆ™": "ä½¿ç”¨ç‡â‰¤70%", "è§¦å‘æ¡ä»¶": "å®æ—¶ç›‘æ§", "åº”å¯¹æªæ–½": "å‡ä»“/è¿½ä¿", "ä¼˜å…ˆçº§": "ä¸­"}
]

# è¡¨10ï¼šèµ„é‡‘é…ç½®æŒ‡å—
capital_guide = [
    {"èµ„é‡‘è§„æ¨¡": "5åƒ-2ä¸‡U", "å•æ¬¡æŠ•å…¥": "1000-3000U", "é£é™©é¢„ç®—": "10-15%", "å¹¶è¡Œæ“ä½œ": "1-2ä¸ª", "é¢„æœŸå¹´åŒ–": "150-300%", "ä¼˜åŠ¿": "çµæ´»ï¼Œæˆæœ¬ä½", "æ³¨æ„äº‹é¡¹": "æ§åˆ¶é¢‘ç‡"},
    {"èµ„é‡‘è§„æ¨¡": "2ä¸‡-10ä¸‡U", "å•æ¬¡æŠ•å…¥": "3000-8000U", "é£é™©é¢„ç®—": "8-12%", "å¹¶è¡Œæ“ä½œ": "2-3ä¸ª", "é¢„æœŸå¹´åŒ–": "200-400%", "ä¼˜åŠ¿": "åˆ†æ•£ï¼Œè§„æ¨¡æ•ˆåº”", "æ³¨æ„äº‹é¡¹": "é€‰ä¼˜è´¨æœºä¼š"},
    {"èµ„é‡‘è§„æ¨¡": "10ä¸‡Uä»¥ä¸Š", "å•æ¬¡æŠ•å…¥": "5000-15000U", "é£é™©é¢„ç®—": "5-8%", "å¹¶è¡Œæ“ä½œ": "3-5ä¸ª", "é¢„æœŸå¹´åŒ–": "150-250%", "ä¼˜åŠ¿": "èµ„é‡‘æ•ˆç‡é«˜", "æ³¨æ„äº‹é¡¹": "æµåŠ¨æ€§ç®¡ç†"}
]

# è¡¨11ï¼šæˆåŠŸè¦ç´ æƒé‡
success_factors = [
    {"æˆåŠŸè¦ç´ ": "è¶‹åŠ¿åˆ¤æ–­èƒ½åŠ›", "æƒé‡": "35%", "è¡¨ç°": "å‡†ç¡®è¯†åˆ«å¸‚åœºçŠ¶æ€", "åŸ¹å…»æ–¹æ³•": "å¤§é‡å®è·µ+ç³»ç»Ÿå¤ç›˜"},
    {"æˆåŠŸè¦ç´ ": "æ‰§è¡Œçºªå¾‹æ€§", "æƒé‡": "25%", "è¡¨ç°": "ä¸¥æ ¼æŒ‰è§„åˆ™æ“ä½œ", "åŸ¹å…»æ–¹æ³•": "åˆ¶åº¦åŒ–+è‡ªæˆ‘ç›‘ç£"},
    {"æˆåŠŸè¦ç´ ": "é£é™©ç®¡ç†æ„è¯†", "æƒé‡": "20%", "è¡¨ç°": "èµ„æœ¬ä¿æŠ¤ä¼˜å…ˆ", "åŸ¹å…»æ–¹æ³•": "ç†å¿µæ•™è‚²+å®æˆ˜ä½“éªŒ"},
    {"æˆåŠŸè¦ç´ ": "å¿ƒç†æ§åˆ¶èƒ½åŠ›", "æƒé‡": "15%", "è¡¨ç°": "æƒ…ç»ªç¨³å®šæ‰§è¡Œ", "åŸ¹å…»æ–¹æ³•": "å¿ƒç†è®­ç»ƒ+ç»éªŒç§¯ç´¯"},
    {"æˆåŠŸè¦ç´ ": "æŠ€æœ¯åˆ†ææŠ€èƒ½", "æƒé‡": "5%", "è¡¨ç°": "åŸºç¡€åˆ†æèƒ½åŠ›", "åŸ¹å…»æ–¹æ³•": "ç³»ç»Ÿå­¦ä¹ +å®è·µ"}
]

# åˆ›å»ºæ‰€æœ‰è¡¨æ ¼çš„å­—å…¸
all_tables = {
    "ç­–ç•¥æ¦‚è¿°": strategy_info,
    "æ ¸å¿ƒæ‰§è¡Œæ•°æ®": cases_data,
    "æ”¶ç›Šæ„æˆåˆ†æ": profit_breakdown,
    "æ ¸å¿ƒKPIç»Ÿè®¡": kpi_summary,
    "æ”¶ç›Šåˆ†å¸ƒç»Ÿè®¡": profit_distribution,
    "ç¯å¢ƒè¡¨ç°åˆ†æ": env_performance,
    "ç­–ç•¥åº”å¯¹æ‰‹å†Œ": strategy_playbook,
    "å»ºä»“æ£€æŸ¥æ¸…å•": entry_checklist,
    "åŠ¨æ€ä»“ä½ç®¡ç†": position_management,
    "é£é™©æ§åˆ¶è§„åˆ™": risk_rules,
    "èµ„é‡‘é…ç½®æŒ‡å—": capital_guide,
    "æˆåŠŸè¦ç´ æƒé‡": success_factors
}

# ç”ŸæˆExcelæ–‡ä»¶ï¼ˆå¤šå·¥ä½œè¡¨ï¼‰
excel_path = output_dir / "æ³¢åŠ¨æ€§æ”¶å‰²æœºç­–ç•¥å®Œæ•´æŠ¥å‘Š.xlsx"
with pd.ExcelWriter(excel_path, engine='openpyxl') as writer:
    for sheet_name, data in all_tables.items():
        df = pd.DataFrame(data)
        df.to_excel(writer, sheet_name=sheet_name, index=False)
        
        # è°ƒæ•´åˆ—å®½
        worksheet = writer.sheets[sheet_name]
        for column in worksheet.columns:
            max_length = 0
            column_letter = column[0].column_letter
            for cell in column:
                try:
                    if len(str(cell.value)) > max_length:
                        max_length = len(str(cell.value))
                except:
                    pass
            adjusted_width = min(max_length + 2, 50)
            worksheet.column_dimensions[column_letter].width = adjusted_width

# ç”Ÿæˆå•ç‹¬çš„CSVæ–‡ä»¶
csv_dir = output_dir / "CSVæ–‡ä»¶"
csv_dir.mkdir(exist_ok=True)
for sheet_name, data in all_tables.items():
    df = pd.DataFrame(data)
    csv_path = csv_dir / f"{sheet_name}.csv"
    df.to_csv(csv_path, index=False, encoding='utf-8-sig')

# ç”ŸæˆJSONæ–‡ä»¶
json_data = {
    "æŠ¥å‘Šç”Ÿæˆæ—¶é—´": datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
    "ç­–ç•¥ç‰ˆæœ¬": "æ³¢åŠ¨æ€§æ”¶å‰²æœº v1.0",
    "æ•°æ®åŸºå‡†": "åŸºäº8ä¸ªæ–°å¸æ¡ˆä¾‹çš„å®Œæ•´å›æµ‹éªŒè¯",
    "è¡¨æ ¼æ•°æ®": all_tables
}

json_path = output_dir / "å®Œæ•´æ•°æ®.json"
with open(json_path, 'w', encoding='utf-8') as f:
    json.dump(json_data, f, ensure_ascii=False, indent=2)

# ç”Ÿæˆå®Œæ•´çš„MarkdownæŠ¥å‘Š
markdown_content = f"""# "æ³¢åŠ¨æ€§æ”¶å‰²æœº"ç­–ç•¥å®Œæ•´å›æµ‹ç»“æœæ€»ç»“æŠ¥å‘Š

## ç­–ç•¥æ ¸å¿ƒç†å¿µ

"æ³¢åŠ¨æ€§æ”¶å‰²æœº"ç­–ç•¥æ˜¯ä¸€ç§**åŸºäºè¶‹åŠ¿åˆ¤æ–­èƒ½åŠ›çš„åŠ¨æ€Deltaç®¡ç†ç³»ç»Ÿ**ã€‚å…¶æ ¸å¿ƒåœ¨äºï¼šåœ¨å…·å¤‡å……è¶³æµåŠ¨æ€§çš„ç°è´§ä¸æ°¸ç»­åˆçº¦å¸‚åœºä¸­ï¼Œä»¥ç­‰åä¹‰ä»·å€¼å»ºç«‹Deltaä¸­æ€§å¯¹å†²ä»“ä½ï¼ŒéšååŸºäºæˆç†Ÿçš„è¶‹åŠ¿åˆ¤æ–­èƒ½åŠ›è¿›è¡Œä¸»åŠ¨Deltaç®¡ç†ã€‚

**ç­–ç•¥å“²å­¦æ ¸å¿ƒï¼š** ä»ä¼ ç»Ÿ"æ–¹å‘æ€§èµŒåš"å‘ç°ä»£"ç§‘å­¦åŒ–é£é™©ç®¡ç†"çš„é‡è¦è¿›åŒ–ã€‚

---

## å›æµ‹æ¡ˆä¾‹æ±‡æ€»

{pd.DataFrame(cases_data).to_markdown(index=False)}

---

## æ ¸å¿ƒç»Ÿè®¡æ•°æ®

{pd.DataFrame(kpi_summary).to_markdown(index=False)}

---

## æ”¶ç›Šåˆ†å¸ƒç»Ÿè®¡

{pd.DataFrame(profit_distribution).to_markdown(index=False)}

---

## ç¯å¢ƒè¡¨ç°åˆ†æ

{pd.DataFrame(env_performance).to_markdown(index=False)}

---

## ç­–ç•¥åº”å¯¹æ‰‹å†Œ

{pd.DataFrame(strategy_playbook).to_markdown(index=False)}

---

## å»ºä»“æ£€æŸ¥æ¸…å•

{pd.DataFrame(entry_checklist).to_markdown(index=False)}

---

## åŠ¨æ€ä»“ä½ç®¡ç†è§„åˆ™

{pd.DataFrame(position_management).to_markdown(index=False)}

---

## é£é™©æ§åˆ¶è§„åˆ™

{pd.DataFrame(risk_rules).to_markdown(index=False)}

---

## èµ„é‡‘é…ç½®æŒ‡å—

{pd.DataFrame(capital_guide).to_markdown(index=False)}

---

## æˆåŠŸè¦ç´ æƒé‡åˆ†æ

{pd.DataFrame(success_factors).to_markdown(index=False)}

---

## é‡è¦é£é™©æç¤º

**ä¸»è¦é£é™©å› ç´ ï¼š**
- å¸‚åœºé£é™©ï¼šæç«¯è¡Œæƒ…å¯èƒ½å¯¼è‡´ç­–ç•¥å¤±æ•ˆ
- æ‰§è¡Œé£é™©ï¼šæŠ€æœ¯æ•…éšœã€ç½‘ç»œå»¶è¿Ÿã€äººä¸ºå¤±è¯¯
- æµåŠ¨æ€§é£é™©ï¼šæ–°å¸æµåŠ¨æ€§æ¯ç«­æˆ–äº¤æ˜“æ‰€é£é™©
- ç³»ç»Ÿæ€§é£é™©ï¼šæ”¿ç­–å˜åŒ–ã€å¸‚åœºæ“çºµç­‰

**é€‚ç”¨äººç¾¤é™åˆ¶ï¼š**
- åŸºç¡€è¦æ±‚ï¼šè‡³å°‘1å¹´ä»¥ä¸Šäº¤æ˜“ç»éªŒï¼Œå…·å¤‡è¶‹åŠ¿åˆ¤æ–­èƒ½åŠ›
- ä¸é€‚åˆï¼šå®Œå…¨æ–°æ‰‹ã€é£é™©æ‰¿å—èƒ½åŠ›æä½è€…

---

**å…è´£å£°æ˜ï¼š** æœ¬æŠ¥å‘Šä»…ä¾›æ•™è‚²å’Œç ”ç©¶ç›®çš„ï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®ã€‚å†å²è¡¨ç°ä¸ä»£è¡¨æœªæ¥æ”¶ç›Šï¼Œä»»ä½•æŠ•èµ„éƒ½å­˜åœ¨äºæŸé£é™©ã€‚

*æŠ¥å‘Šç”Ÿæˆæ—¶é—´ï¼š{datetime.now().strftime("%Y-%m-%d %H:%M:%S")}*
*ç­–ç•¥ç‰ˆæœ¬ï¼šæ³¢åŠ¨æ€§æ”¶å‰²æœº v1.0*
"""

markdown_path = output_dir / "å®Œæ•´ç­–ç•¥æŠ¥å‘Š.md"
with open(markdown_path, 'w', encoding='utf-8') as f:
    f.write(markdown_content)

print("âœ… æ–‡ä»¶ç”Ÿæˆå®Œæˆï¼")
print(f"ğŸ“ è¾“å‡ºç›®å½•ï¼š{output_dir.resolve()}")
print(f"ğŸ“Š Excelæ–‡ä»¶ï¼š{excel_path.name}")
print(f"ğŸ“„ CSVæ–‡ä»¶å¤¹ï¼š{csv_dir.name}")
print(f"ğŸ”§ JSONæ•°æ®ï¼š{json_path.name}")
print(f"ğŸ“ MarkdownæŠ¥å‘Šï¼š{markdown_path.name}")
